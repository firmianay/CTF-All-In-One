# 1.6.3 åˆ†ç»„å¯†ç 

**author : Odyssey@cyberpeace**

- [åˆ†ç»„å¯†ç æ¦‚è¿°](#åˆ†ç»„å¯†ç æ¦‚è¿°)
- [åˆ†ç»„åŠ å¯†æ³•çš„æ¨¡å¼](#åˆ†ç»„åŠ å¯†æ³•çš„æ¨¡å¼)
- [ä¹˜ç§¯åŠ å¯†æ³•](#ä¹˜ç§¯åŠ å¯†æ³•)
- [DESåŠ å¯†æŠ€æœ¯](#DESåŠ å¯†æŠ€æœ¯)
- [å·®åˆ†å¯†ç åˆ†æžä¸Žçº¿æ€§å¯†ç åˆ†æž](#å·®åˆ†å¯†ç åˆ†æžä¸Žçº¿æ€§å¯†ç åˆ†æž)
- [3DESåŠ å¯†æŠ€æœ¯](#3desåŠ å¯†æŠ€æœ¯)
- [AESç®—æ³•](#aesç®—æ³•)

### åˆ†ç»„å¯†ç æ¦‚è¿°

åœ¨ä»Šå¤©æˆ‘ä»¬æ‰€ä½¿ç”¨çš„åŠ å¯†æ³•ä¸­ï¼Œåˆ†ç»„åŠ å¯†æ˜¯æœ€å¸¸è§çš„ç±»åž‹ã€‚åˆ†ç»„åŠ å¯†æ³•æ¯æ¬¡ä½œç”¨äºŽå›ºå®šå¤§å°çš„åˆ†ç»„ï¼ˆä¸Žæµå¯†ç ç›¸åï¼Œæµå¯†ç æ¯æ¬¡åªåŠ å¯†ä¸€ä½ï¼‰ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªåˆ†ç»„çš„æ¯”ç‰¹æ•°å°±ç§°ä¸ºåˆ†ç»„é•¿åº¦ã€‚

![](files/3-1.png)

åœ¨è®¸å¤šå¯†ç ç³»ç»Ÿä¸­ï¼Œå•é’¥åˆ†ç»„å¯†ç æ˜¯ç³»ç»Ÿå®‰å…¨çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç”¨åˆ†ç»„å¯†ç æ˜“äºŽæž„é€ ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ã€æµå¯†ç ã€æ¶ˆæ¯è®¤è¯ç ï¼ˆMACï¼‰å’Œæ‚å‡‘å‡½æ•°ç­‰ï¼Œè¿˜å¯è¿›è€Œæˆä¸ºæ¶ˆæ¯è®¤è¯æŠ€æœ¯ã€æ•°æ®å®Œæ•´æ€§æœºåˆ¶ã€å®žä½“è®¤è¯åè®®ä»¥åŠå•é’¥æ•°å­—ç­¾å­—ä½“åˆ¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ã€‚å®žé™…åº”ç”¨ä¸­å¯¹äºŽåˆ†ç»„å¯†ç å¯èƒ½æå‡ºå¤šæ–¹é¢çš„è¦æ±‚ï¼Œé™¤äº†å®‰å…¨æ€§å¤–ï¼Œè¿˜æœ‰è¿è¡Œé€Ÿåº¦ã€å­˜å‚¨é‡ï¼ˆç¨‹åºçš„é•¿åº¦ã€æ•°æ®åˆ†ç»„é•¿åº¦ã€é«˜é€Ÿç¼“å­˜å¤§å°ï¼‰ã€å®žçŽ°å¹³å°ï¼ˆç¡¬ä»¶ã€è½¯ä»¶ã€èŠ¯ç‰‡ï¼‰ã€è¿è¡Œæ¨¡å¼ç­‰é™åˆ¶æ¡ä»¶ã€‚è¿™äº›éƒ½éœ€è¦ä¸Žå®‰å…¨æ€§è¦æ±‚ä¹‹é—´è¿›è¡Œé€‚å½“çš„æŠ˜ä¸­é€‰æ‹©ã€‚

#### 3.1.1 åˆ†ç»„å¯†ç çš„è®¾è®¡åŽŸåˆ™

**è®¾è®¡çš„ç®—æ³•åº”æ»¡è¶³ä¸‹è¿°è¦æ±‚**

â‘  åˆ†ç»„é•¿åº¦nè¦è¶³å¤Ÿå¤§ï¼Œä½¿åˆ†ç»„ä»£æ¢å­—æ¯è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°2nè¶³å¤Ÿå¤§ï¼Œé˜²æ­¢æ˜Žæ–‡ç©·ä¸¾æ”»å‡»æ³•å¥æ•ˆã€‚
DESã€IDEAã€FEALå’ŒLOKIç­‰åˆ†ç»„å¯†ç éƒ½é‡‡ç”¨n=64ï¼Œåœ¨ç”Ÿæ—¥æ”»å‡»ä¸‹ç”¨232ç»„å¯†æ–‡æˆåŠŸæ¦‚çŽ‡ä¸º1/2ï¼ŒåŒæ—¶è¦æ±‚232Ã—64b=215MBå­˜è´®ï¼Œæ•…é‡‡ç”¨ç©·ä¸¾æ”»å‡»æ˜¯ä¸çŽ°å®žçš„ã€‚
â‘¡ å¯†é’¥é‡è¦è¶³å¤Ÿå¤§ï¼ˆå³ç½®æ¢å­é›†ä¸­çš„å…ƒç´ è¶³å¤Ÿå¤šï¼‰ï¼Œå°½å¯èƒ½æ¶ˆé™¤å¼±å¯†é’¥å¹¶ä½¿æ‰€æœ‰å¯†é’¥åŒç­‰åœ°å¥½ï¼Œä»¥é˜²æ­¢å¯†é’¥ç©·ä¸¾æ”»å‡»å¥æ•ˆã€‚
ä½†å¯†é’¥åˆä¸èƒ½è¿‡é•¿ï¼Œä»¥ä¾¿äºŽå¯†é’¥çš„ç®¡ç†ã€‚
DESé‡‡ç”¨56æ¯”ç‰¹å¯†é’¥ï¼Œå¤ªçŸ­äº†ï¼ŒIDEAé‡‡ç”¨128æ¯”ç‰¹å¯†é’¥ï¼Œæ®ä¼°è®¡ï¼Œåœ¨ä»ŠåŽ30ï½ž40å¹´å†…é‡‡ç”¨80 æ¯”ç‰¹å¯†é’¥æ˜¯è¶³å¤Ÿå®‰å…¨çš„ã€‚
â‘¢ ç”±å¯†é’¥ç¡®å®šç½®æ¢çš„ç®—æ³•è¦è¶³å¤Ÿå¤æ‚ï¼Œå……åˆ†å®žçŽ°æ˜Žæ–‡ä¸Žå¯†é’¥çš„æ‰©æ•£å’Œæ··æ·†ï¼Œæ²¡æœ‰ç®€å•çš„å…³ç³»å¯å¾ªï¼Œèƒ½æŠ—å‡»å„ç§å·²çŸ¥çš„æ”»å‡»ï¼Œå¦‚å·®åˆ†æ”»å‡»å’Œçº¿æ€§æ”»å‡»ï¼›æœ‰é«˜çš„éžçº¿æ€§é˜¶æ•°ï¼Œå®žçŽ°å¤æ‚çš„å¯†ç å˜æ¢ï¼›ä½¿å¯¹æ‰‹ç ´è¯‘æ—¶é™¤äº†ç”¨ç©·ä¸¾æ³•å¤–ï¼Œæ— å…¶å®ƒæ·å¾„å¯å¾ªã€‚
â‘£ åŠ å¯†å’Œè§£å¯†è¿ç®—ç®€å•ï¼Œæ˜“äºŽè½¯ä»¶å’Œç¡¬ä»¶é«˜é€Ÿå®žçŽ°ã€‚å¦‚å°†åˆ†ç»„nåŒ–åˆ†ä¸ºå­æ®µï¼Œæ¯æ®µé•¿ä¸º8ã€16æˆ–è€…32ã€‚åœ¨ä»¥è½¯ä»¶å®žçŽ°æ—¶ï¼Œåº”é€‰ç”¨ç®€å•çš„è¿ç®—ï¼Œä½¿ä½œç”¨äºŽå­æ®µä¸Šçš„å¯†ç è¿ç®—æ˜“äºŽä»¥æ ‡å‡†å¤„ç†å™¨çš„åŸºæœ¬è¿ç®—ï¼Œå¦‚åŠ ã€ä¹˜ã€ç§»ä½ç­‰å®žçŽ°ï¼Œé¿å…ç”¨ä»¥è½¯ä»¶éš¾äºŽå®žçŽ°çš„é€æ¯”ç‰¹ç½®æ¢ã€‚ä¸ºäº†ä¾¿äºŽç¡¬ä»¶å®žçŽ°ï¼ŒåŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä¹‹é—´çš„å·®åˆ«åº”ä»…åœ¨äºŽç”±ç§˜å¯†å¯†é’¥æ‰€ç”Ÿæˆçš„å¯†é’¥è¡¨ä¸åŒè€Œå·²ã€‚è¿™æ ·ï¼ŒåŠ å¯†å’Œè§£å¯†å°±å¯ç”¨åŒä¸€å™¨ä»¶å®žçŽ°ã€‚è®¾è®¡çš„ç®—æ³•é‡‡ç”¨è§„åˆ™çš„æ¨¡å—ç»“æž„ï¼Œå¦‚å¤šè½®è¿­ä»£ç­‰ï¼Œä»¥ä¾¿äºŽè½¯ä»¶å’ŒVLSIå¿«é€Ÿå®žçŽ°ã€‚æ­¤å¤–ï¼Œå·®é”™ä¼ æ’­å’Œæ•°æ®æ‰©å±•è¦å°½å¯èƒ½åœ°å°ã€‚
â‘¤ æ•°æ®æ‰©å±•å°½å¯èƒ½åœ°å°ã€‚ä¸€èˆ¬æ— æ•°æ®æ‰©å±•ï¼Œåœ¨é‡‡ç”¨åŒæ€ç½®æ¢å’ŒéšæœºåŒ–åŠ å¯†æŠ€æœ¯æ—¶å¯å¼•å…¥æ•°æ®æ‰©å±•ã€‚
â‘¥ å·®é”™ä¼ æ’­å°½å¯èƒ½åœ°å°ã€‚

#### 3.1.2 æ··æ·†ä¸Žæ‰©æ•£

æ‰©æ•£å’Œæ··æ·†æ˜¯ç”±Shannonæå‡ºçš„è®¾è®¡å¯†ç ç³»ç»Ÿçš„ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼Œç›®çš„æ˜¯æŠ—å‡»æ”»å‡»è€…å¯¹å¯†ç ç³»ç»Ÿçš„ç»Ÿè®¡åˆ†æžã€‚
å¦‚æžœæ”»å‡»è€…çŸ¥é“æ˜Žæ–‡çš„æŸäº›ç»Ÿè®¡ç‰¹æ€§ï¼Œå¦‚æ¶ˆæ¯ä¸­ä¸åŒå­—æ¯å‡ºçŽ°çš„é¢‘çŽ‡ã€å¯èƒ½å‡ºçŽ°çš„ç‰¹å®šå•è¯æˆ–çŸ­è¯­ï¼Œè€Œä¸”è¿™äº›ç»Ÿè®¡ç‰¹æ€§ä»¥æŸç§æ–¹å¼åœ¨å¯†æ–‡ä¸­åæ˜ å‡ºæ¥ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±æœ‰å¯èƒ½å¾—å‡ºåŠ å¯†å¯†é’¥æˆ–å…¶ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…å¾—å‡ºåŒ…å«åŠ å¯†å¯†é’¥çš„ä¸€ä¸ªå¯èƒ½çš„å¯†é’¥é›†åˆã€‚

- æ··æ·†ï¼ˆConfusionï¼‰ï¼šæ˜¯ä¸€ç§ä½¿å¯†é’¥ä¸Žå¯†æ–‡ä¹‹é—´çš„å…³ç³»å°½å¯èƒ½æ¨¡ç³Šçš„åŠ å¯†æ“ä½œã€‚è®¾è®¡è€…å¸Œæœ›è®©å¯†æ–‡çš„ç»Ÿè®¡ç‰¹æ€§ä¸Žå¯†é’¥çš„å–å€¼ä¹‹é—´çš„å…³ç³»å°½å¯èƒ½å¤æ‚åŒ–ï¼Œä»¥ä½¿å¯†é’¥å’Œæ˜Žæ–‡ä»¥åŠå¯†æ–‡ä¹‹é—´çš„ä¾èµ–æ€§å¯¹å¯†ç åˆ†æžè€…æ¥è¯´æ˜¯æ— æ³•åˆ©ç”¨çš„ã€‚å®žçŽ°æ··æ·†å¸¸ç”¨çš„ä¸€ä¸ªå…ƒç´ å°±æ˜¯æ›¿æ¢ï¼›è¿™ä¸ªå…ƒç´ éƒ½åœ¨DESå’ŒAESä¸­éƒ½æœ‰ä½¿ç”¨ã€‚
- æ‰©æ•£ï¼ˆDiffusionï¼‰ï¼šæ˜¯ä¸€ç§ä¸ºäº†éšè—æ˜Žæ–‡çš„ç»Ÿè®¡å±žæ€§è€Œå°†ä¸€ä¸ªæ˜Žæ–‡ç¬¦å·çš„å½±å“æ‰©æ•£åˆ°å¤šä¸ªå¯†æ–‡ç¬¦å·çš„åŠ å¯†æ“ä½œï¼Œä»¥ä¾¿åœ¨å¤§é‡çš„å¯†æ–‡ä¸­æ¶ˆé™¤æ˜Žæ–‡çš„ç»Ÿè®¡ç»“æž„ã€‚æœ€ç®€å•çš„æ‰©æ•£å…ƒç´ å°±æ˜¯ç½®æ¢ï¼Œå®ƒå¸¸ç”¨äºŽDESä¸­ï¼›è€ŒAESåˆ™ä½¿ç”¨æ›´é«˜çº§çš„Mixcolunmæ“ä½œã€‚
æ‰©æ•£å’Œæ··æ·†æˆåŠŸåœ°å®žçŽ°äº†åˆ†ç»„å¯†ç çš„æœ¬è´¨å±žæ€§ï¼Œå› è€Œæˆä¸ºè®¾è®¡çŽ°ä»£åˆ†ç»„å¯†ç çš„åŸºç¡€ã€‚

### åˆ†ç»„åŠ å¯†æ³•çš„æ¨¡å¼

**ä»€ä¹ˆæ˜¯æ¨¡å¼**
åˆ†ç»„å¯†ç åªèƒ½åŠ å¯†å›ºå®šé•¿åº¦çš„åˆ†ç»„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åŠ å¯†çš„æ˜Žæ–‡é•¿åº¦å¯èƒ½ä¼šè¶…è¿‡åˆ†ç»„å¯†ç çš„åˆ†ç»„é•¿åº¦ï¼Œè¿™æ—¶å°±éœ€è¦å¯¹åˆ†ç»„å¯†ç ç®—æ³•è¿›è¡Œè¿­ä»£ï¼Œä»¥ä¾¿å°†ä¸€æ®µå¾ˆé•¿çš„æ˜Žæ–‡å…¨éƒ¨åŠ å¯†ã€‚è¿™ä¸ªè¿­ä»£çš„æ–¹æ³•å°±ç§°ä¸ºåˆ†ç»„å¯†ç çš„æ¨¡å¼ï¼ˆmodeï¼‰ã€‚
åœ¨ä»‹ç»æ¨¡å¼å‰æˆ‘ä»¬å¼•å…¥ä¸¤ä¸ªæœ¯è¯­ï¼š
æ˜Žæ–‡åˆ†ç»„ï¼ˆ$M_n$ï¼‰ï¼šæŒ‡åˆ†ç»„å¯†ç ç®—æ³•ä¸­ä½œä¸ºåŠ å¯†å¯¹è±¡çš„æ˜Žæ–‡ï¼Œæ˜Žæ–‡åˆ†ç»„çš„é•¿åº¦ä¸Žåˆ†ç»„å¯†ç ç®—æ³•çš„åˆ†ç»„é•¿åº¦æ˜¯ç­‰é•¿çš„ã€‚
å¯†æ–‡åˆ†ç»„ï¼ˆ$C_n$ï¼‰ï¼šæŒ‡ä½¿ç”¨åˆ†ç»„å¯†ç ç®—æ³•å°†æ˜Žæ–‡åˆ†ç»„åŠ å¯†ä¹‹åŽæ‰€ç”Ÿæˆçš„å¯†æ–‡ã€‚

#### 3.2.1 ç”µå­ç¼–ç è–„æ¨¡å¼ï¼ˆECBï¼‰

è¿™æ˜¯åˆ†ç»„åŠ å¯†æœ€ç®€å•çš„ä¸€ç§æ¨¡å¼ï¼Œå³æ˜Žæ–‡çš„æ¯ä¸€ä¸ªå—åŠ å¯†æˆå¯†æ–‡çš„æ¯ä¸€ä¸ªå—ã€‚æ˜Žæ–‡è¢«åˆ†ä¸ºè‹¥å¹²å—$(M_1,M_2,M_3,M_4, â€¦ ,M_n)$ï¼Œé€šè¿‡åŠ å¯†æ–¹æ³•$E_k$ï¼Œå¾—åˆ°å¯†æ–‡$(C_1,C_2,C_3,C_4,â€¦,C_n)$ï¼Œå½“æœ€åŽä¸€ä¸ªæ˜Žæ–‡åˆ†ç»„å°äºŽåˆ†ç»„é•¿åº¦æ—¶ï¼Œéœ€è¦ç”¨ä¸€äº›ç‰¹å®šçš„æ•°æ®è¿›è¡Œå¡«å……ã€‚

![](files/3-2-1.png)

è§£å¯†è¿‡ç¨‹ä¹Ÿæ˜¯ä¸€æ¬¡å¯¹ä¸€ä¸ªåˆ†ç»„è§£å¯†ï¼Œè€Œä¸”æ¯æ¬¡è§£å¯†éƒ½ä½¿ç”¨åŒä¸€å¯†é’¥ã€‚
![](files/3-2-1-2.png)

- ECBæ¨¡å¼çš„ç‰¹ç‚¹
ECBæ¨¡å¼æ˜¯æ‰€æœ‰æ¨¡å¼ä¸­æœ€ç®€å•çš„ä¸€ç§ã€‚ECBæ¨¡å¼ä¸­ï¼Œæ˜Žæ–‡åˆ†ç»„ä¸Žå¯†æ–‡åˆ†ç»„æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œå› æ­¤ï¼Œå¦‚æžœæ˜Žæ–‡ä¸­å­˜åœ¨å¤šä¸ªç›¸åŒçš„æ˜Žæ–‡åˆ†ç»„ï¼Œåˆ™è¿™äº›æ˜Žæ–‡åˆ†ç»„æœ€ç»ˆéƒ½å°†è¢«è½¬æ¢ä¸ºç›¸åŒçš„ å¯†æ–‡åˆ†ç»„ã€‚è¿™æ ·ä¸€æ¥ï¼Œåªè¦è§‚å¯Ÿä¸€ä¸‹å¯†æ–‡ï¼Œå°±å¯ä»¥çŸ¥é“æ˜Žæ–‡ä¸­å­˜åœ¨æ€Žä¹ˆæ ·çš„é‡å¤ç»„åˆï¼Œå¹¶å¯ä»¥ä»¥æ­¤ä¸ºçº¿ç´¢æ¥ç ´è¯‘å¯†ç ï¼Œå› æ­¤ECBæ¨¡å¼æ˜¯å­˜åœ¨ä¸€å®šé£Žé™©çš„ã€‚

- å¯¹ECBæ¨¡å¼çš„æ”»å‡»
ECBæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªæ˜Žæ–‡åˆ†ç»„éƒ½æ˜¯å„è‡ªç‹¬ç«‹åœ°è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œä½†è¿™å…¶å®žæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¼±ç‚¹ã€‚å‡å¦‚å­˜åœ¨ä¸€ä¸ªæ”»å‡»è€…ï¼Œå½“ä»–ä½œä¸ºä¸­é—´äººæˆªèŽ·ä¸¤æ–¹çš„é€šä¿¡æ—¶ï¼Œä»–èƒ½å¤Ÿæ”¹å˜å¯†æ–‡çš„åˆ†ç»„é¡ºåºï¼Œå½“æŽ¥æ”¶è€…å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†æ—¶ï¼Œç”±äºŽå¯†æ–‡åˆ†ç»„çš„é¡ºåºè¢«æ”¹å˜äº†ï¼Œå› æ­¤ç›¸åº”çš„æ˜Žæ–‡åˆ†ç»„çš„é¡ºåºä¹Ÿè¢«æ”¹å˜äº†ï¼Œé‚£ä¹ˆæŽ¥æ”¶è€…å®žé™…ä¸Šæ˜¯è§£å¯†å‡ºäº†ä¸€æ®µè¢«ç¯¡æ”¹åŽçš„å¯†æ–‡ã€‚åœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œæ”»å‡»è€…ä¸éœ€è¦ç ´è¯‘å¯†ç ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“åˆ†ç»„å¯†ç çš„ç®—æ³•ï¼Œä»–åªéœ€è¦çŸ¥é“å“ªä¸ªåˆ†ç»„è®°å½•äº†ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚
æ€è€ƒä¸€ä¸ªæ¨¡æ‹Ÿçš„åœºæ™¯ï¼š

å‡è®¾åˆ†ç»„çš„é•¿åº¦ä¸º128æ¯”ç‰¹ï¼ˆ16å­—èŠ‚ï¼‰ï¼ŒæŸé“¶è¡Œçš„è½¬è´¦è¯·æ±‚æ•°æ®ç”±ä»¥ä¸‹ä¸‰ä¸ªåˆ†ç»„æž„æˆã€‚
åˆ†ç»„1ï¼šä»˜æ¬¾äººçš„é“¶è¡Œè´¦å·
åˆ†ç»„2ï¼šæ”¶æ¬¾äººçš„é“¶è¡Œè´¦å·
åˆ†ç»„3ï¼šè½¬è´¦é‡‘é¢
æ­¤æ—¶æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªè½¬è´¦è¯·æ±‚æ•°æ®ï¼šä»ŽA-5374å¸å·å‘B-6671å¸å·è½¬è´¦1äº¿å…ƒï¼Œç”¨16è¿›åˆ¶æ•°æ®è¡¨ç¤ºï¼š
æ˜Žæ–‡åˆ†ç»„1=41 2D 35 33 37 34 20 20 20 20 20 20 20 20 20 20 ï¼ˆä»˜æ¬¾äººï¼šA-5374ï¼‰
æ˜Žæ–‡åˆ†ç»„2=42 2D 36 36 37 31 20 20 20 20 20 20 20 20 20 20 ï¼ˆæ”¶æ¬¾äººï¼šB-6671ï¼‰
æ˜Žæ–‡åˆ†ç»„3=31 30 30 30 30 30 30 30 30 20 20 20 20 20 20 20 ï¼ˆè½¬è´¦é‡‘é¢ï¼š100000000ï¼‰

æŽ¥ä¸‹æ¥ï¼Œæ”»å‡»è€…å°†å¯†æ–‡åˆ†ç»„1å’Œ2çš„å†…å®¹è¿›è¡Œå¯¹è°ƒã€‚ï¼ˆæ­¤æ—¶æ”»å‡»è€…å¹¶ä¸çŸ¥é“åˆ†ç»„çš„å…·ä½“å†…å®¹ï¼Œä½†çŸ¥é“è¿™æ˜¯ä»˜æ¬¾äººä¿¡æ¯ï¼‰
æ˜Žæ–‡åˆ†ç»„2=42 2D 36 36 37 31 20 20 20 20 20 20 20 20 20 20 ï¼ˆæ”¶æ¬¾äººï¼šB-6671ï¼‰
æ˜Žæ–‡åˆ†ç»„1=41 2D 35 33 37 34 20 20 20 20 20 20 20 20 20 20 ï¼ˆä»˜æ¬¾äººï¼šA-5374ï¼‰
æ˜Žæ–‡åˆ†ç»„3=31 30 30 30 30 30 30 30 30 20 20 20 20 20 20 20 ï¼ˆè½¬è´¦é‡‘é¢ï¼š100000000ï¼‰
å½“é“¶è¡Œå¯¹ä¿¡æ¯è¿›è¡Œè§£å¯†æ—¶ï¼Œä¿¡æ¯çš„å†…å®¹å®žé™…ä¸Šå·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œä»˜æ¬¾äººçš„èº«ä»½å’Œæ”¶æ¬¾äººçš„èº«ä»½å·²ç»è¢«è°ƒæ¢äº†ã€‚
è¿™å°±æ˜¯ECBæ¨¡å¼çš„æœ€å¤§å¼±ç‚¹ï¼Œå¯ä»¥åœ¨ä¸ç ´è¯‘å¯†æ–‡çš„æƒ…å†µä¸‹æ“çºµå¯†æ–‡ã€‚

#### 3.2.2 å¯†ç åˆ†ç»„é“¾æŽ¥æ¨¡å¼ï¼ˆCBCï¼‰

è¿™ä¸ªæ¨¡å¼çš„å®žçŽ°æ›´å¤æ‚ã€æ›´å®‰å…¨ï¼Œå› æ­¤å®ƒæ˜¯ä½¿ç”¨æœ€æ™®éçš„å—åŠ å¯†æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¥è‡ªä¸Šä¸€å—çš„å¯†æ–‡ä¸Žå½“å‰æ˜Žæ–‡å—åšXORé€»è¾‘è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æžœæ‰æ˜¯åŠ å¯†çš„ä½å—ã€‚

![](files/3-2-2.png)

å¦‚æžœä¸ºæ¯ä¸ªæ¶ˆæ¯ä¼ è¾“é€‰å–ä¸åŒçš„IVï¼Œé‚£ä¹ˆä¸¤ä¸ªç›¸åŒçš„æ¶ˆæ¯å³ä½¿ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œä¹Ÿå°†æœ‰ä¸åŒçš„å¯†æ–‡ã€‚è¿™å¤§å¤§æé«˜äº†å®‰å…¨æ€§ã€‚é—®é¢˜åœ¨äºŽï¼šæŽ¥æ”¶ç«¯å¦‚ä½•çŸ¥é“æ‰€ä½¿ç”¨çš„IVå‘¢ï¼Ÿ
ä¸€ç§æ–¹æ³•æ˜¯åœ¨ä¸å®‰å…¨çš„é€šé“ä¸Šå‘é€è¯¥IVï¼Œå¹¶ä¸”è¯¥IVåªä½¿ç”¨ä¸€æ¬¡ï¼Œæ°¸ä¸é‡å¤ã€‚
å¦å¤–ä¸€ç§æ–¹æ³•å°±æ˜¯åŸºäºŽå”¯ä¸€æ•°çš„æ¦‚å¿µã€‚å”¯ä¸€æ•°æ˜¯ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—ï¼Œæ°¸è¿œä¸é‡å¤ä½¿ç”¨çš„å¯†é’¥ï¼Œå®ƒä¸ä¸€å®šéžå¾—ä¿å¯†ï¼Œå®ƒå¯ä»¥æ˜¯æ¶ˆæ¯çš„æ•°ç›®ç­‰ã€‚ç”¨å—åŠ å¯†æ³•å°†å”¯ä¸€æ•°åŠ å¯†åŽç”ŸæˆIVã€‚å¦‚æžœå”¯ä¸€æ•°é™„åŠ åˆ°å¯†æ–‡å‰é¢ï¼ŒæŽ¥æ”¶ç«¯å°±å¯ä»¥è¿˜åŽŸIVã€‚

- CBCæ¨¡å¼çš„ç‰¹ç‚¹
åœ¨CBCæ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æ— æ³•å•ç‹¬å¯¹ä¸€ä¸ªä¸­é—´çš„æ˜Žæ–‡åˆ†ç»„è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å…¥è¦ç”Ÿæˆç¬¬ä¸‰ç»„å¯†æ–‡ï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦å‡‘é½åˆ†ç»„1,2,3æ‰è¡Œã€‚
è§‚å¯ŸCBCæ¨¡å¼çš„è§£å¯†è¿‡ç¨‹ï¼Œæˆ‘ä»¬å‘çŽ°ï¼šå¦‚æžœåŠ å¯†åŽçš„åˆ†ç»„C2å‡ºçŽ°å†…å®¹é”™è¯¯ï¼ˆå­˜å‚¨ä»‹è´¨æ•…éšœæˆ–è€…ç½‘ç»œä¼ è¾“ä¸­çš„è¯¯ç ç­‰ï¼‰ä½¿å¾—ä¸€ä¸ªåˆ†ç»„ä¸­çš„0å˜æˆäº†1ã€‚é‚£ä¹ˆè§£å¯†çš„æ—¶å€™æœ€å¤šåªä¼šè®©2ä¸ªåˆ†ç»„å†…å®¹å—åˆ°æ•°æ®æŸåçš„å½±å“ã€‚
![](files/3-2-2-2.png)

ä½†æ˜¯ï¼Œå¦‚æžœä¸æ˜¯æ•°æ®å‡ºé”™ï¼Œè€Œæ˜¯å¯†æ–‡åˆ†ç»„ä¸­æœ‰æ¯”ç‰¹ç¼ºå¤±ï¼Œé‚£ä¹ˆå³ä½¿ä¸¢å¤±ä¸€ä¸ªæ¯”ç‰¹ï¼Œä¹Ÿä¼šå¯¼è‡´å¯†æ–‡åˆ†ç»„çš„é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼ŒåŽç»­çš„åˆ†ç»„å‘ç”Ÿé”™ä½ï¼Œæœ€ç»ˆå¯¼è‡´åŽé¢çš„æ‰€æœ‰å¯†æ–‡åˆ†ç»„éƒ½ä¼šè§£å¯†å‡ºæ— æ•ˆçš„æ•°æ®ã€‚
![](files/3-2-2-3.png)

- å¯¹CBCæ¨¡å¼çš„æ”»å‡»
1. æ¯”ç‰¹åè½¬
å¦‚æžœæ”»å‡»è€…æˆªèŽ·äº†ä¼ é€’ä¿¡æ¯ï¼Œåœ¨è¿™æ®µä¿¡æ¯ä¸­åŒ…å«äº†åˆå§‹å‘é‡IVï¼Œæ ¹æ®CBCæ¨¡å¼çš„è§£å¯†æ–¹å¼æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æžœæ”»å‡»è€…å¯¹IVä¸­çš„ä»»æ„æ¯”ç‰¹è¿›è¡Œåè½¬ï¼ˆ1å˜ä¸º0ï¼Œ0å˜ä¸º1ï¼‰ï¼Œé‚£ä¹ˆæ˜Žæ–‡ä¸­ç›¸åº”çš„æ¯”ç‰¹ä½å°±ä¼šå‘ç”Ÿåè½¬ã€‚
![](files/3-2-2-4.png)

- å¯¹CBCæ¨¡å¼çš„æ”»å‡»
2. å¡«å……æç¤ºæ”»å‡»
å¡«å……æç¤ºæ˜¯ä¸€ç§åˆ©ç”¨åˆ†ç»„å¯†ç ä¸­å¤ªéš¾å†²éƒ¨åˆ†æ¥è¿›è¡Œæ”»å‡»çš„æ–¹æ³•ã€‚åœ¨åˆ†ç»„å¯†ç ä¸­ï¼Œå½“æ˜Žæ–‡é•¿åº¦ä¸ä¸ºåˆ†ç»„é•¿åº¦çš„æ•´æ•°å€æ—¶ï¼Œéœ€è¦åœ¨æœ€åŽä¸€ä¸ªåˆ†ç»„ä¸­å¡«å……ä¸€äº›æ•°æ®ä½¿å…¶å‡‘æ»¡ä¸€ä¸ªåˆ†ç»„é•¿åº¦ã€‚åœ¨å¡«å……æç¤ºæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä¼šåå¤å‘é€ä¸€æ®µå¯†æ–‡ï¼Œæ¯æ¬¡å‘é€æ—¶éƒ½å¯¹å¡«å……å†…å®¹è¿›è¡Œå°‘è®¸ä¿®æ”¹ã€‚ç”±äºŽæŽ¥æ”¶è€…ï¼ˆæœåŠ¡å™¨ï¼‰åœ¨æ— æ³•æ­£ç¡®è§£å¯†æ—¶ä¼šè¿”å›žä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œæ”»å‡»è€…é€šè¿‡è¿™ä¸ªé”™è¯¯æ¶ˆæ¯å°±å¯ä»¥èŽ·å–ä¸€éƒ¨åˆ†ä¸Žæ˜Žæ–‡ç›¸å…³çš„ä¿¡æ¯ï¼Œå½“ç„¶è¿™ä¸ªæ–¹æ³•ä¸ä»…ä»…é€‚ç”¨äºŽCBCæ¨¡å¼ï¼Œè€Œæ˜¯é€‚ç”¨äºŽæ‰€æœ‰éœ€è¦è¿›è¡Œåˆ†ç»„å¡«å……çš„æ¨¡å¼ã€‚è¦é˜²å¾¡è¿™ç§æ”»å‡»ï¼Œå°±å¿…é¡»éªŒè¯å¯†æ–‡æ˜¯å¦æ˜¯ç”±åˆæ³•çš„å‘é€è€…åœ¨çŸ¥é“æ˜Žæ–‡å†…å®¹çš„å‰æä¸‹ç”Ÿæˆçš„ã€‚

#### 3.2.3 å¯†æ–‡åé¦ˆæ¨¡å¼ï¼ˆCFBï¼‰

åœ¨CFBæ¨¡å¼ä¸­ï¼Œå‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„ä¼šè¢«é€å›žåˆ°å¯†ç ç®—æ³•çš„è¾“å…¥ç«¯ï¼Œè¿™é‡Œçš„åé¦ˆæŒ‡çš„æ˜¯è¿”å›žè¾“å…¥ç«¯çš„æ„æ€ã€‚
åœ¨ECBæ¨¡å¼å’ŒCBCæ¨¡å¼ä¸­ï¼Œæ˜Žæ–‡åˆ†ç»„éƒ½æ˜¯é€šè¿‡å¯†ç ç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œç„¶è€Œï¼Œåœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜Žæ–‡åˆ†ç»„å¹¶æ²¡æœ‰é€šè¿‡å¯†ç ç®—æ³•æ¥ç›´æŽ¥è¿›è¡ŒåŠ å¯†ã€‚
![](files/3-2-3.png)

CFBæ¨¡å¼çš„è§£å¯†è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼Œè§£å¯†ç®—æ³•å’ŒåŠ å¯†çš„ç®—æ³•æ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°†CFBæ¨¡å¼çœ‹ä½œæ˜¯ä¸€ç§é€šè¿‡åˆ†ç»„å¯†ç æ¥å®žçŽ°æµåŠ å¯†çš„æ–¹å¼ï¼ŒCFBæ¨¡å¼ä¸­çš„å¯†ç ç®—æ³•ç›¸å½“äºŽç”¨æ¥ç”Ÿæˆä¼ªéšæœºæ•°å’Œå¯†æ–‡è¿›è¡ŒXORè¿ç®—ã€‚é€šè¿‡ä¹‹å‰å¯¹æµå¯†ç çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“æµå¯†ç çš„åŠ å¯†è§£å¯†çš„ç®—æ³•æ˜¯ç›¸åŒã€‚
![](files/3-2-3-2.png)

**å¯¹CFBæ¨¡å¼çš„æ”»å‡»**

1. é‡æ”¾æ”»å‡»
ä¸¾ä¸€ä¸ªä¾‹å­ï¼šAliceå‘Bobå‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯ç”±4ä¸ªå¯†æ–‡åˆ†åˆ«ç»„æˆã€‚æ”»å‡»è€…å°†æ¶ˆæ¯çš„åŽ3ä¸ªå¯†æ–‡åˆ†ç»„ä¿å­˜ä¸‹æ¥ï¼Œç¬¬äºŒå¤©ï¼ŒAliceåˆå‘Bobå‘é€äº†å†…å®¹ä¸åŒçš„4ä¸ªå¯†æ–‡åˆ†ç»„ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾Aliceä½¿ç”¨çš„å¯†é’¥æ˜¯æ²¡æœ‰å˜çš„ï¼‰ã€‚æ”»å‡»è€…å°†æ˜¨å¤©ä¿å­˜ä¸‹æ¥çš„3ä¸ªåˆ†ç»„åˆ†åˆ«æ›¿æ¢äº†è¿™æ®µå¯†æ–‡çš„åŽ3ä¸ªåˆ†ç»„ã€‚å½“Bobè§£å¯†çš„æ—¶å€™ï¼Œ4ä¸ªåˆ†ç»„ä¸­åªæœ‰ç¬¬ä¸€ä¸ªå¯ä»¥è§£å¯†æˆåŠŸï¼Œè€Œç¬¬2ç»„å°±ä¼šäº§ç”Ÿé”™è¯¯ï¼Œç„¶è€Œç¬¬3å’Œç¬¬4åˆ™è¢«æ›¿æ¢æˆäº†æ”»å‡»è€…ä¿å­˜ä¸‹æ¥çš„ä¹‹å‰ä½¿ç”¨è¿‡çš„åˆ†ç»„ï¼ŒBobä»ç„¶å¯ä»¥æ­£å¸¸è§£å¯†ã€‚æ­¤æ—¶ç¬¬2ä¸ªåˆ†ç»„æˆä¸ºäº†ä¸€ä¸ªé”™è¯¯çš„åˆ†ç»„ï¼Œä½†Bobæ— æ³•ç¡®è®¤æ˜¯ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­çš„é€šä¿¡é”™è¯¯ï¼Œè¿˜æ˜¯è¢«äººç¯¡æ”¹çš„ã€‚

#### 3.2.3 å¯†æ–‡åé¦ˆæ¨¡å¼ï¼ˆCFBï¼‰

![](files/3-2-3-3.png)

#### 3.2.4 è¾“å‡ºåé¦ˆæ¨¡å¼ï¼ˆOFBï¼‰

è¿™ä¸ªæ¨¡å¼ä½¿ç”¨åˆ†ç»„åŠ å¯†æ³•æ¥ç”Ÿæˆä¸€ä¸ªå¯†é’¥æµã€‚å¯†é’¥å’Œå—åŠ å¯†æ³•çš„åˆå§‹è¾“å…¥å¯åŠ¨è¿™ä¸ªåŠ å¯†è¿‡ç¨‹ï¼Œé€šè¿‡å°†å—åŠ å¯†æ³•çš„è¾“å‡ºåŠ å¯†ã€‚è§£å¯†çš„è¿‡ç¨‹åŒæ ·æ˜¯å¯¹åˆå§‹å‘é‡åšåŠ å¯†è¿ç®—ï¼Œå°†å¾—åˆ°çš„å¯†é’¥æµä¸Žå¯†æ–‡åšXORè¿ç®—ã€‚
![](files/3-2-4.png)

- CFBæ¨¡å¼ä¸ŽOFBæ¨¡å¼çš„å¯¹æ¯”
OFBæ¨¡å¼å’ŒCFBæ¨¡å¼çš„åŒºåˆ«ä»…ä»…åœ¨äºŽå¯†ç ç®—æ³•çš„è¾“å…¥ã€‚
CFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•çš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªå¯†æ–‡åˆ†ç»„ï¼Œä¹Ÿå°±æ˜¯å°†å¯†æ–‡åˆ†ç»„åé¦ˆåˆ°å¯†ç ç®—æ³•ä¸­ï¼Œå› æ­¤å°±æœ‰äº†â€œå¯†æ–‡åé¦ˆæ¨¡å¼â€è¿™ä¸ªåå­—ã€‚
OFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•çš„è¾“å…¥åˆ™æ˜¯å¯†ç ç®—æ³•çš„å‰ä¸€ä¸ªè¾“å‡ºï¼Œä¹Ÿå°±æ˜¯å°†è¾“å‡ºåé¦ˆç»™å¯†ç ç®—æ³•ï¼Œå› æ­¤å°±æœ‰äº†â€œè¾“å‡ºåé¦ˆæ¨¡å¼â€è¿™ä¸ªåå­—ã€‚

#### 3.2.5 è®¡æ•°å™¨æ¨¡å¼ï¼ˆCTRï¼‰

CTRæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªåˆ†ç»„å¯¹åº”ä¸€ä¸ªé€æ¬¡ç´¯åŠ çš„è®¡æ•°å™¨ï¼Œå¹¶é€šè¿‡å¯¹è®¡æ•°å™¨è¿›è¡ŒåŠ å¯†æ¥ç”Ÿæˆå¯†é’¥æµã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ç»ˆçš„å¯†æ–‡åˆ†ç»„æ˜¯é€šè¿‡å°†è®¡æ•°å™¨åŠ å¯†å¾—åˆ°çš„æ¯”ç‰¹æµï¼Œä¸Žæ˜Žæ–‡åˆ†ç»„è¿›è¡ŒXORè¿ç®—å¾—åˆ°çš„ã€‚
![](files/3-2-5.png)

- è®¡æ•°å™¨çš„ç”Ÿæˆæ–¹æ³•
æ¯æ¬¡åŠ å¯†æ˜¯éƒ½ä¼šç”Ÿæˆä¸€ä¸ªä¸åŒçš„å€¼ï¼ˆnonceï¼‰æ¥ä½œä¸ºè®¡æ•°å™¨çš„åˆå§‹å€¼ã€‚ä¾‹å¦‚ï¼šå½“åˆ†ç»„é•¿åº¦ä¸º128æ¯”ç‰¹ï¼ˆ16å­—èŠ‚ï¼‰æ—¶ï¼Œè®¡æ•°å™¨çš„åˆå§‹å€¼å¯èƒ½æ˜¯åƒè¿™æ ·çš„å½¢å¼ã€‚
![](files/3-2-5-2.png)

å…¶ä¸­ï¼Œå‰8ä¸ªå­—èŠ‚ä¸ºnonceï¼Œè¿™ä¸ªå€¼åœ¨æ¯æ¬¡åŠ å¯†æ—¶å¿…é¡»éƒ½æ˜¯ä¸åŒçš„ã€‚åŽ8ä¸ªå­—èŠ‚ä¸ºåˆ†ç»„åºå·ï¼Œè¿™ä¸ªéƒ¨åˆ†æ˜¯ä¼šåœ¨åŠ å¯†çš„è¿‡ç¨‹ä¸­é€æ¬¡ç´¯åŠ çš„ã€‚

66 1F 98 CD 37 A3 8B 4B 00 00 00 00 00 00 00 01	æ˜Žæ–‡åˆ†ç»„1çš„è®¡æ•°å™¨
66 1F 98 CD 37 A3 8B 4B 00 00 00 00 00 00 00 02	æ˜Žæ–‡åˆ†ç»„2çš„è®¡æ•°å™¨
66 1F 98 CD 37 A3 8B 4B 00 00 00 00 00 00 00 03	æ˜Žæ–‡åˆ†ç»„3çš„è®¡æ•°å™¨
66 1F 98 CD 37 A3 8B 4B 00 00 00 00 00 00 00 04	æ˜Žæ–‡åˆ†ç»„4çš„è®¡æ•°å™¨

### ä¹˜ç§¯åŠ å¯†æ³•

**ä¹˜ç§¯åŠ å¯†æ³•çš„æ¦‚å¿µ**

1973å¹´ï¼Œ Feistelæå‡ºäº†ä¸€ç§ä¹˜ç§¯åŠ å¯†æ³•ï¼Œå®ƒæˆä¸ºä»Šå¤©æ‰€ç”¨çš„å¯¹ç§°åŠ å¯†æ³•çš„ä½“ç³»ç»“æž„åŸºç¡€ã€‚
ä¹˜ç§¯åŠ å¯†æ³•æŒ‡çš„æ˜¯ï¼šé¡ºåºåœ°æ‰§è¡Œä¸¤ä¸ªæˆ–å¤šä¸ªåŸºæœ¬å¯†ç ç³»ç»Ÿï¼Œä½¿å¾—æœ€åŽç»“æžœçš„å¯†ç å¼ºåº¦é«˜äºŽæ¯ä¸ªåŸºæœ¬å¯†ç ç³»ç»Ÿäº§ç”Ÿçš„ç»“æžœ.
Feistelè¿˜æå‡ºäº†å®žçŽ°ä»£æ¢å’Œç½®æ¢çš„æ–¹æ³•ã€‚å…¶æ€æƒ³å®žé™…ä¸Šæ˜¯Shannonæå‡ºçš„åˆ©ç”¨ä¹˜ç§¯å¯†ç å®žçŽ°æ··æ·†å’Œæ‰©æ•£æ€æƒ³çš„å…·ä½“åº”ç”¨ã€‚

#### 3.3.1 ä¹˜ç§¯åŠ å¯†æ³•çš„ç»“æž„

![](files/3-3-1.png)

è¾“å…¥æ˜¯åˆ†ç»„é•¿ä¸º2ð‘¤çš„æ˜Žæ–‡å’Œä¸€ä¸ªå¯†é’¥Kã€‚å°†æ¯ç»„æ˜Žæ–‡åˆ†æˆå·¦å³ä¸¤åŠð¿_0å’Œð‘…_0  ï¼Œåœ¨è¿›è¡Œå®Œnè½®è¿­ä»£åŽï¼Œå·¦å³ä¸¤åŠå†åˆå¹¶åˆ°ä¸€èµ·ä»¥äº§ç”Ÿå¯†æ–‡åˆ†ç»„ã€‚å…¶ç¬¬iè½®è¿­ä»£çš„è¾“å…¥ä¸ºå‰ä¸€è½®è¾“å‡ºçš„å‡½æ•°ï¼š

$ L_i = R_{i-1} $
$R_i=L_{i-1} \bigoplus F(R_{i-1},K_i)$

å…¶ä¸­ï¼Œ$K_i$æ˜¯ç¬¬iè½®ç”¨çš„å­å¯†é’¥ï¼Œç”±åŠ å¯†å¯†é’¥Kå¾—åˆ°ã€‚é€šå¸¸ï¼Œå„è½®å­å¯†é’¥å½¼æ­¤ä¸åŒè€Œä¸”ä¸ŽKä¹Ÿä¸åŒã€‚

#### 3.3.2 ä¹˜ç§¯åŠ å¯†æ³•çš„è§£å¯†è¿‡ç¨‹

ä¹˜ç§¯åŠ å¯†æ³•è§£å¯†è¿‡ç¨‹æœ¬è´¨ä¸Šå’ŒåŠ å¯†è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œç®—æ³•ä½¿ç”¨å¯†æ–‡ä½œä¸ºè¾“å…¥ï¼Œä½†ä½¿ç”¨å­å¯†é’¥Kiçš„æ¬¡åºä¸ŽåŠ å¯†è¿‡ç¨‹ç›¸åï¼Œå³ç¬¬1è½®ä½¿ç”¨Knï¼Œç¬¬2è½®ä½¿ç”¨Kn-1ï¼Œâ€¦â€¦ï¼Œæœ€åŽä¸€è½®ä½¿ç”¨K1ã€‚è¿™ä¸€ç‰¹æ€§ä¿è¯äº†è§£å¯†å’ŒåŠ å¯†å¯é‡‡ç”¨åŒä¸€ç®—æ³•ã€‚

![](files/3-3-2.png)

åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼š
$LE_{16}=RE_{15}$
$RE_{16}=LE\bigoplus F(RE_{15},K_{16})$
åœ¨è§£å¯†è¿‡ç¨‹ä¸­ï¼š
$LD_1=RD_0=LE_{16}=RE_{15}$
$RD_1=LD_0 \bigoplus F(RD_0,K_{16})=RE_{16} \bigoplus F(RE_{15},K_{16})$
    $=[LE_{15} \bigoplus F(RE_{15},K_{16})] \bigoplus F(RE_{15},K_{16})$
    $=LE_{15}$

æ‰€ä»¥è§£å¯†è¿‡ç¨‹ç¬¬1è½®çš„è¾“å‡ºä¸ºLE15â€–RE15ï¼Œç­‰äºŽåŠ å¯†è¿‡ç¨‹ç¬¬16è½®è¾“å…¥å·¦å³ä¸¤åŠäº¤æ¢åŽçš„ç»“æžœã€‚å®¹æ˜“è¯æ˜Žè¿™ç§å¯¹åº”å…³ç³»åœ¨16è½®ä¸­æ¯è½®éƒ½æˆç«‹ã€‚ä¸€èˆ¬åœ°ï¼ŒåŠ å¯†è¿‡ç¨‹çš„ç¬¬iè½®æœ‰
$LE_i=RE_{i-1}$
$RE_i=LE_{i-1}\bigoplus F(RE_{i-1},K_{i})$
å› æ­¤
$RE_{i-1}=LE_i$
$LE_{i-1}=RE_i \bigoplus F(RE_{i-1},K_i)=RE_i \bigoplus F(LE_i,K_i)$

#### 3.3.3 ä¹˜ç§¯åŠ å¯†æ³•çš„ç‰¹ç‚¹

ä¹˜ç§¯åŠ å¯†æ³•çš„å®žçŽ°ä¸Žä»¥ä¸‹å‚æ•°å’Œç‰¹æ€§æœ‰å…³ï¼š
â‘  åˆ†ç»„å¤§å°: åˆ†ç»„è¶Šå¤§åˆ™å®‰å…¨æ€§è¶Šé«˜ï¼Œä½†åŠ å¯†é€Ÿåº¦å°±è¶Šæ…¢ã€‚åˆ†ç»„å¯†ç è®¾è®¡ä¸­æœ€ä¸ºæ™®éä½¿ç”¨çš„åˆ†ç»„å¤§å°æ˜¯64æ¯”ç‰¹ã€‚
â‘¡ å¯†é’¥å¤§å°ï¼šå¯†é’¥è¶Šé•¿åˆ™å®‰å…¨æ€§è¶Šé«˜ï¼Œä½†åŠ å¯†é€Ÿåº¦å°±è¶Šæ…¢ã€‚çŽ°åœ¨æ™®éè®¤ä¸º64æ¯”ç‰¹æˆ–æ›´çŸ­çš„å¯†é’¥é•¿åº¦æ˜¯ä¸å®‰å…¨çš„ï¼Œé€šå¸¸ä½¿ç”¨128æ¯”ç‰¹çš„å¯†é’¥é•¿åº¦ã€‚
â‘¢ è½®æ•°ï¼šå•è½®ç»“æž„è¿œä¸è¶³ä»¥ä¿è¯å®‰å…¨æ€§ï¼Œä½†å¤šè½®ç»“æž„å¯æä¾›è¶³å¤Ÿçš„å®‰å…¨æ€§ã€‚å…¸åž‹åœ°ï¼Œè½®æ•°å–ä¸º16ã€‚
â‘£ å­å¯†é’¥äº§ç”Ÿç®—æ³•ï¼šè¯¥ç®—æ³•çš„å¤æ‚æ€§è¶Šå¤§ï¼Œåˆ™å¯†ç åˆ†æžçš„å›°éš¾æ€§å°±è¶Šå¤§ã€‚
â‘¤ è½®å‡½æ•°ï¼šè½®å‡½æ•°çš„å¤æ‚æ€§è¶Šå¤§ï¼Œå¯†ç åˆ†æžçš„å›°éš¾æ€§ä¹Ÿè¶Šå¤§ã€‚

åœ¨è®¾è®¡ä¹˜ç§¯åŠ å¯†æ³•ï¼ˆFeistelç½‘ç»œï¼‰æ—¶ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢éœ€è¦è€ƒè™‘ï¼š
â‘  å¿«é€Ÿçš„è½¯ä»¶å®žçŽ°ï¼šåœ¨å¾ˆå¤šæƒ…å†µä¸­ï¼Œç®—æ³•æ˜¯è¢«é•¶åµŒåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå› è€Œæ— æ³•ç”¨ç¡¬ä»¶å®žçŽ°ã€‚æ­¤æ—¶ç®—æ³•çš„æ‰§è¡Œé€Ÿåº¦æ˜¯è€ƒè™‘çš„å…³é”®ã€‚
â‘¡ ç®—æ³•å®¹æ˜“åˆ†æžï¼šå¦‚æžœç®—æ³•èƒ½è¢«æ— ç–‘ä¹‰åœ°è§£é‡Šæ¸…æ¥šï¼Œå°±å¯å®¹æ˜“åœ°åˆ†æžç®—æ³•æŠµæŠ—æ”»å‡»çš„èƒ½åŠ›ï¼Œæœ‰åŠ©äºŽè®¾è®¡é«˜å¼ºåº¦çš„ç®—æ³•ã€‚

### DESåŠ å¯†æŠ€æœ¯

- DESçš„è¯žç”Ÿä¸Žè°¢å¹•
æ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆ data encryption standard, DES ï¼‰æ˜¯1977å¹´ç¾Žå›½è”é‚¦ä¿¡æ¯å¤„ç†æ ‡å‡†ï¼ˆFIPSï¼‰ä¸­æ‰€é‡‡ç”¨çš„ä¸€ç§å¯¹ç§°å¯†ç ã€‚
å®ƒæ˜¯ç”±ç¾Žå›½IBMå…¬å¸ç ”åˆ¶çš„ï¼Œæ˜¯æ—©æœŸçš„ç§°ä½œLuciferå¯†ç çš„ä¸€ç§å‘å±•å’Œä¿®æ”¹ã€‚DESåœ¨1975å¹´3æœˆ17æ—¥é¦–æ¬¡è¢«å…¬å¸ƒåœ¨è”é‚¦è®°å½•ä¸­ï¼Œç»è¿‡å¤§é‡çš„å…¬å¼€è®¨è®ºåŽï¼ŒDESäºŽ1977å¹´1æœˆ15æ—¥è¢«æ­£å¼æ‰¹å‡†å¹¶ä½œä¸ºç¾Žå›½è”é‚¦ä¿¡æ¯å¤„ç†æ ‡å‡†ï¼Œå³FIPS-46ï¼ŒåŒå¹´7æœˆ15æ—¥å¼€å§‹ç”Ÿæ•ˆã€‚è§„å®šæ¯éš”5å¹´ç”±ç¾Žå›½å›½å®¶ä¿å¯†å±€ï¼ˆnational security agency, NSAï¼‰ä½œå‡ºè¯„ä¼°ï¼Œå¹¶é‡æ–°æ‰¹å‡†å®ƒæ˜¯å¦ç»§ç»­ä½œä¸ºè”é‚¦åŠ å¯†æ ‡å‡†ã€‚

æœ€åŽçš„ä¸€æ¬¡è¯„ä¼°æ˜¯åœ¨1994å¹´1æœˆï¼Œç¾Žå›½å·²å†³å®š1998å¹´12æœˆä»¥åŽå°†ä¸å†ä½¿ç”¨DESã€‚1997å¹´DESCHALLå°ç»„ç»è¿‡è¿‘4ä¸ªæœˆçš„åŠªåŠ›ï¼Œé€šè¿‡Internetæœç´¢äº†3Ã—1016ä¸ªå¯†é’¥ï¼Œæ‰¾å‡ºäº†DESçš„å¯†é’¥ï¼Œæ¢å¤å‡ºäº†æ˜Žæ–‡ã€‚1998å¹´5æœˆç¾Žå›½EFF(electronics frontier foundation)å®£å¸ƒï¼Œä»–ä»¬ä»¥ä¸€å°ä»·å€¼20ä¸‡ç¾Žå…ƒçš„è®¡ç®—æœºæ”¹è£…æˆçš„ä¸“ç”¨è§£å¯†æœºï¼Œç”¨56å°æ—¶ç ´è¯‘äº†56 æ¯”ç‰¹å¯†é’¥çš„DESã€‚ç¾Žå›½å›½å®¶æ ‡å‡†å’ŒæŠ€æœ¯åä¼šå·²å¾é›†å¹¶è¿›è¡Œäº†å‡ è½®è¯„ä¼°ã€ç­›é€‰ï¼Œäº§ç”Ÿäº†ç§°ä¹‹ä¸ºAES(advanced encryption standard) çš„æ–°åŠ å¯†æ ‡å‡†ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒDESå¯¹äºŽæŽ¨åŠ¨å¯†ç ç†è®ºçš„å‘å±•å’Œåº”ç”¨æ¯•ç«Ÿèµ·äº†é‡å¤§ä½œç”¨ï¼Œå¯¹äºŽæŽŒæ¡åˆ†ç»„å¯†ç çš„åŸºæœ¬ç†è®ºã€è®¾è®¡æ€æƒ³å’Œå®žé™…åº”ç”¨ä»ç„¶æœ‰ç€é‡è¦çš„å‚è€ƒä»·å€¼ã€‚

#### 3.4.1 DESç®—æ³•æ¦‚è¿°

å°½ç®¡DESå¯†é’¥æœ‰64ä½ï¼Œä½†ç”¨æˆ·åªèƒ½å®šä¹‰å…¶ä¸­çš„56ä½ï¼Œå…¶ä½™çš„8ä½ç”±ç®—æ³•æä¾›ã€‚åˆ†åˆ«æ”¾åœ¨8ã€16ã€24ã€32ã€40ã€48ã€56å’Œ64ä½ä¸Šã€‚ä¹Ÿå°±æ˜¯æ¯8ä½çš„å¯†é’¥ä¸­åŒ…å«äº†ç”¨æˆ·æä¾›çš„7ä½å’ŒDESç¡®å®šçš„1ä½ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†è®©æ¯ä¸ª8ä½çš„å—éƒ½æœ‰å¥‡æ•°ä¸ªå¥‡å¶æ ¡éªŒä½ï¼ˆå³1çš„ä¸ªæ•°ä¸ºå¥‡æ•°ï¼‰ã€‚
![](files/3-4-1.png)

DESçš„åŸºæœ¬ç»“æž„æ˜¯ç”±ä¹˜ç§¯åŠ å¯†ç®—æ³•ç»„æˆçš„ã€‚å®ƒå¯¹æ˜Žæ–‡ä¸­æ¯ä¸€ä¸ªåˆ†ç»„çš„åŠ å¯†è¿‡ç¨‹éƒ½åŒ…å«16è½®ï¼Œä¸”æ¯è½®çš„æ“ä½œå®Œå…¨ç›¸åŒã€‚æ¯ä¸€è½®éƒ½ä¼šä½¿ç”¨ä¸åŒçš„å­å¯†é’¥ï¼Œæ¯ä¸ªå­å¯†é’¥kiéƒ½æ˜¯ä»Žä¸»å¯†é’¥kä¸­æŽ¨å¯¼å‡ºæ¥çš„ã€‚

![](files/3-4-1-2.png)

#### 3.4.2 DESç®—æ³•çš„ç»“æž„

![](files/3-4-2.png)

![](files/3-4-2-2.png)

æ ¹æ®Feistelç®—æ³•å¯çŸ¥ï¼Œåœ¨æ¯ä¸€è½®ä¸­ï¼Œå®žé™…æ˜¯å°†å³åŠéƒ¨åˆ†Rié€å…¥å‡½æ•°fä¸­ï¼Œå‡½æ•°çš„è¾“å‡ºå°†ä¸Ž32ä½çš„å·¦åŠéƒ¨åˆ†Liè¿›è¡ŒXORè¿ç®—ï¼Œæœ€åŽå·¦å³äº¤æ¢ã€‚

#### 3.4.3 åˆå§‹ç½®æ¢å’Œé€†åˆå§‹ç½®æ¢

å¦‚å›¾æ‰€ç¤ºï¼Œåˆå§‹ç½®æ¢IPä¸Žé€†åˆå§‹ç½®æ¢IP-1éƒ½æ˜¯æŒ‰ä½ç½®æ¢ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°æƒ³è±¡æˆä¸€ä¸ªç®€å•æ›¿æ¢å¯†ç ã€‚ä¾‹å¦‚ï¼šè¾“å…¥çš„ç¬¬58ä½åœ¨ç½®æ¢åŽæ˜ å°„åˆ°ç¬¬1ä½ã€‚
![](files/3-4-3.png)

å¦‚æžœå†å–é€†åˆå§‹ç½®æ¢Y=IP-1(X)=IP-1(IP(M))ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªæ¯”ç‰¹ä½çš„åˆå§‹é¡ºåºå°†è¢«æ¢å¤ã€‚
![](files/3-4-3-2.png)

#### 3.4.4 få‡½æ•°

få‡½æ•°åœ¨DESçš„å®‰å…¨æ€§ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚åœ¨ç¬¬iè½®ä¸­ï¼Œfå‡½æ•°çš„è¾“å…¥ä¸ºå‰ä¸€è½®è¾“å‡ºçš„å³åŠéƒ¨åˆ†Ri-1å’Œå½“å‰è½®å­å¯†é’¥kiã€‚få‡½æ•°çš„è¾“å‡ºå°†ç”¨æ¥å‚ä¸ŽXORè¿ç®—ï¼ŒåŠ å¯†å·¦åŠéƒ¨åˆ†è¾“å…¥ä½Li-1ã€‚
Få‡½æ•°çš„ç»“æž„å¦‚å›¾æ‰€ç¤ºï¼š
![](files/3-4-3-3.png)

- å°†è¾“å…¥åˆ†æˆ8ä¸ª4ä½çš„åˆ†ç»„ï¼Œç„¶åŽå°†æ¯ä¸ªåˆ†ç»„æ‰©å±•ä¸º6ä½ï¼Œä»Žè€Œå°†32ä½çš„è¾“å…¥æ‰©å±•ä¸º48ä½ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨E-ç›’ä¸­è¿›è¡Œã€‚
- æŽ¥ç€å°†æ‰©å±•åŽçš„48ä½ä¸Žæœ¬è½®çš„å­å¯†é’¥kiè¿›è¡ŒXORè¿ç®—ï¼Œå°†48ä½æ‹†ä¸º8ä¸ª6ä½é•¿çš„åˆ†ç»„åˆ†åˆ«æ”¾å…¥8ä¸ªä¸åŒçš„æ›¿æ¢ç›’ä¸­ï¼Œè¿™ä¸ªæ›¿æ¢ç›’å«S-ç›’ã€‚
- ä»ŽSç›’ä¸­å¾—åˆ°32ä½çš„è¾“å‡ºï¼Œç„¶åŽå†ç”¨ç½®æ¢Pè¿›è¡ŒæŒ‰ä½ç½®æ¢ã€‚

**E-ç›’**

E-ç›’æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç½®æ¢ã€‚å®ƒéœ€è¦å°†32ä½çš„æ¯”ç‰¹æ‰©å±•ä¸º48ä½ã€‚
- å°†32æ¯”ç‰¹åˆ†ä¸º8ä¸ª4ä½çš„åˆ†ç»„
- å°†4ä½çš„åˆ†ç»„æ‹“å±•ä¸º6ä½ï¼Œå˜æˆ8ä¸ª6ä½åˆ†ç»„
![](files/3-4-4.png)

**S-ç›’**
Sç›’æ˜¯DESçš„æ ¸å¿ƒï¼Œå®ƒå°†6ä½çš„è¾“å…¥æ˜ å°„ä¸º4ä½çš„è¾“å‡ºï¼Œä¸ºDESæä¾›äº†éžçº¿æ€§ç‰¹å¾ï¼Œè¿™æ„å‘³ç€å³ä½¿ç»™å®šä¸€ä¸ªè¾“å…¥-è¾“å‡ºå€¼çš„é›†åˆï¼Œä¹Ÿå¾ˆéš¾é¢„ä¼°æ‰€æœ‰Sç›’çš„è¾“å‡ºã€‚ å°½ç®¡NBS/NISTæ—©åœ¨1977å¹´å°±å‘å¸ƒDESçš„å®Œæ•´è§„èŒƒï¼Œä½†å´ä»Žæ¥æ²¡æœ‰å®Œæ•´æŠ«éœ²è¿‡S-ç›’è¡¨çš„é€‰æ‹©åŠ¨æœºã€‚è¿™ä¸ªäº‹å®žå¼•å‘äº†äººä»¬çš„å¾ˆå¤šçŒœæµ‹ï¼Œå°¤å…¶æ˜¯å…³äºŽæ˜¯å¦å­˜åœ¨åªæœ‰NSAæ‰èƒ½ç ´è§£çš„ç§˜å¯†åŽé—¨çš„å¯èƒ½æ€§æˆ–ä¸€äº›å…¶ä»–æ•…æ„æž„é€ çš„ç¼ºé™·ã€‚
å¯¹æ¯ä¸ªç›’Siï¼Œå…¶6æ¯”ç‰¹è¾“å…¥ä¸­ï¼Œç¬¬1ä¸ªå’Œç¬¬6ä¸ªæ¯”ç‰¹å½¢æˆä¸€ä¸ª2ä½äºŒè¿›åˆ¶æ•°ï¼Œç”¨æ¥é€‰æ‹©Siçš„4ä¸ªä»£æ¢ä¸­çš„ä¸€ä¸ªã€‚6æ¯”ç‰¹è¾“å…¥ä¸­ï¼Œä¸­é—´4ä½ç”¨æ¥é€‰æ‹©åˆ—ã€‚è¡Œå’Œåˆ—é€‰å®šåŽï¼Œå¾—åˆ°å…¶äº¤å‰ä½ç½®çš„åè¿›åˆ¶æ•°ï¼Œå°†è¿™ä¸ªæ•°è¡¨ç¤ºä¸º4ä½äºŒè¿›åˆ¶æ•°å³å¾—è¿™ä¸€Sç›’çš„è¾“å‡ºã€‚

**S-ç›’**

ä¾‹å¦‚ï¼ŒS1 çš„è¾“å…¥ä¸º011001ï¼Œè¡Œé€‰ä¸º01ï¼ˆå³ç¬¬1è¡Œï¼‰ï¼Œåˆ—é€‰ä¸º1100ï¼ˆå³ç¬¬12åˆ—ï¼‰ï¼Œè¡Œåˆ—äº¤å‰ä½ç½®çš„æ•°ä¸º9ï¼Œå…¶4ä½äºŒè¿›åˆ¶è¡¨ç¤ºä¸º1001ï¼Œæ‰€ä»¥S1çš„è¾“å‡ºä¸º1001ã€‚
Sç›’çš„æ¯ä¸€è¡Œå®šä¹‰äº†ä¸€ä¸ªå¯é€†ä»£æ¢ã€‚

![](files/3-4-4-1.png)

![](files/3-4-4-2.png)

![](files/3-4-4-3.png)

![](files/3-4-4-4.png)

![](files/3-4-4-5.png)

![](files/3-4-4-6.png)

![](files/3-4-4-7.png)

![](files/3-4-4-8.png)

**S-ç›’çš„è®¾è®¡å‡†åˆ™**

- æ¯ä¸ªS-ç›’éƒ½æœ‰6ä¸ªè¾“å…¥ä½å’Œ4ä¸ªè¾“å‡ºä½
- ä»»æ„ä¸€ä¸ªè¾“å‡ºä½éƒ½ä¸åº”è¯¥å¤ªæŽ¥è¿‘äºŽè¾“å…¥ä½çš„çº¿æ€§ç»„åˆ
- å¦‚æžœè¾“å…¥çš„æœ€é«˜ä½å’Œæœ€ä½Žä½éƒ½æ˜¯å›ºå®šçš„ï¼Œåªæœ‰ä¸­é—´çš„4ä¸ªä½æ˜¯å¯å˜çš„ï¼Œåˆ™æ¯ä¸ªå¯èƒ½çš„4ä½è¾“å‡ºå€¼éƒ½å¿…é¡»åªå‡ºçŽ°ä¸€æ¬¡ã€‚
- å¯¹äºŽS-ç›’çš„ä¸¤ä¸ªè¾“å…¥ï¼Œå¦‚æžœä»…æœ‰1ä½ä¸åŒï¼Œåˆ™è¾“å‡ºå¿…é¡»è‡³å°‘æœ‰ä¸¤ä½ä¸åŒã€‚
- å¯¹äºŽS-ç›’çš„ä¸¤ä¸ªè¾“å…¥ï¼Œå¦‚æžœåªæœ‰ä¸­é—´ä¸¤ä½ä¸åŒï¼Œåˆ™è¾“å‡ºå¿…é¡»è‡³å°‘æœ‰ä¸¤ä½ä¸åŒã€‚
- å¯¹äºŽS-ç›’çš„ä¸¤ä¸ªè¾“å…¥ï¼Œå¦‚æžœå¼€å¤´çš„ä¸¤ä½ä¸åŒï¼Œä½†æœ€åŽä¸¤ä½ç›¸åŒï¼Œåˆ™è¾“å‡ºå¿…é¡»ä¸åŒã€‚
- å¯¹ä»»æ„æœ‰6ä½éžé›¶å·®åˆ†çš„è¾“å…¥å¯¹ï¼Œ32å¯¹è¾“å…¥ä¸­è‡³å¤šæœ‰8å¯¹æœ‰ç›¸åŒçš„è¾“å‡ºå·®åˆ†ã€‚
- 8ä¸ªS-ç›’å¯¹åº”çš„32ä½è¾“å‡ºçš„å†²çªï¼ˆé›¶è¾“å‡ºå·®å¼‚ï¼‰åªæœ‰åœ¨ä¸‰ä¸ªç›¸é‚»çš„S-ç›’çš„æƒ…å†µä¸‹æ‰æœ‰å¯èƒ½ã€‚

**ç½®æ¢P**

32ä½çš„è¾“å‡ºä¼šæ ¹æ®ä¸‹è¡¨ä¸­ç»™å‡ºçš„ç½®æ¢Pè¿›è¡ŒæŒ‰ä½ç½®æ¢ã€‚ä¸Žåˆå§‹ç½®æ¢IPä»¥åŠé€†åˆå§‹ç½®æ¢IP-1ä¸åŒï¼Œç½®æ¢På°†æ‰©æ•£å¼•å…¥åˆ°DESä¸­ï¼Œå› æ­¤æ¯ä¸ªS-ç›’çš„å››ä½è¾“å‡ºéƒ½ä¼šè¿›è¡Œç½®æ¢ï¼Œä½¿å¾—æ¯ä½åœ¨ä¸‹ä¸€è½®ä¸­ä¼šå½±å“å¤šä¸ªä¸åŒçš„S-ç›’ã€‚
ç”±æ‰©å……å¸¦æ¥çš„æ‰©æ•£ã€S-ç›’ä¸Žç½®æ¢På¯ä»¥ä¿è¯ï¼Œåœ¨ç¬¬äº”è½®ç»“æŸæ—¶æ¯ä¸ªä½éƒ½æ˜¯æ˜Žæ–‡ä½ä¸Žå¯†é’¥ä½çš„å‡½æ•°ã€‚è¿™ç§è¡Œä¸ºç§°ä¸ºé›ªå´©æ•ˆåº”ã€‚

![](files/3-4-4-9.png)

#### 3.4.5 å¯†é’¥ç”Ÿæˆ

![](files/3-4-5.png)

#### 3.4.5 å¯†é’¥ç”Ÿæˆ

- ç”¨ç½®æ¢è¡¨PC-1è¿›è¡Œç½®æ¢æ“ä½œï¼ŒåŒæ—¶åŽ»é™¤å¥‡å¶æ ¡éªŒä½ã€‚
- å°†å¯†é’¥åˆ†ä¸ºC0å’ŒD0ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¹¶è¿›è¡Œå·¦ä½ç§»ï¼ˆå¾ªçŽ¯ç§»ä½ï¼‰æ“ä½œï¼Œç”ŸæˆC1å’ŒC2ã€‚
- C1å’ŒC2æ ¹æ®ç½®æ¢è¡¨PC-2å†æ¬¡è¿›è¡Œç½®æ¢æ“ä½œç”Ÿæˆå­å¯†é’¥k1ã€‚
- C1å’ŒC2è¿›è¡Œå·¦ä½ç§»æ“ä½œï¼Œç”ŸæˆC3å’ŒC4ã€‚

#### 3.4.5 å¯†é’¥ç”Ÿæˆ

**åˆå§‹å¯†é’¥ç½®æ¢PC-1**

åœ¨ç½®æ¢è¡¨ä¸­å¿½ç•¥ç¬¬8ã€16ã€24ã€32ã€40ã€48ã€56ã€64ä½ï¼Œåœ¨ç½®æ¢çš„åŒæ—¶åŽ»æŽ‰å¥‡å¶æ ¡éªŒã€‚ç½®æ¢è¡¨å¦‚ä¸‹ï¼š
![](files/3-4-5-2.png)

**ç§»ä½æ“ä½œ**

å¾—åˆ°çš„56ä½å¯†é’¥è¢«åˆ†ä¸ºC0å’ŒD0ä¸¤éƒ¨åˆ†ï¼Œå‘¨æœŸæ€§åœ°å‘å·¦ç§»åŠ¨ä¸€ä½æˆ–è€…ä¸¤ä½ï¼ˆå³å¾ªçŽ¯ç§»ä½ï¼‰ï¼Œç§»åŠ¨çš„å…·ä½“ä½æ•°åˆ™å–å†³äºŽè½®æ•°iï¼Œå…¶è§„åˆ™ä¸ºï¼š
- å½“i=1,2,9,16è½®æ—¶ï¼Œå·¦å³ä¸¤éƒ¨åˆ†å‘å·¦ç§»åŠ¨ä¸€ä½
- å½“iâ‰ 1,2,9,16è½®æ—¶ï¼Œå·¦å³ä¸¤ä¸ªéƒ¨åˆ†å‘å·¦ç§»åŠ¨ä¸¤ä½ã€‚

æ³¨æ„ï¼šå¾ªçŽ¯ç§»ä½è¦ä¹ˆå‘ç”Ÿåœ¨å·¦åŠéƒ¨åˆ†ï¼Œè¦ä¹ˆå‘ç”Ÿåœ¨å³åŠéƒ¨åˆ†ã€‚
å¾ªçŽ¯ç§»åŠ¨ä½ç½®çš„æ€»æ•°ä¸º$4*1+12*2=28$ ã€‚è¿™å°†å¸¦æ¥ä¸€ä¸ªæœ‰è¶£çš„å±žæ€§ï¼Œå³$C_0=C_{16}$å’Œ$D_0=D_{16}$ ã€‚

**PC-2**

ä¸ºäº†å¾—åˆ°48ä½çš„å­å¯†é’¥kiï¼Œå·¦å³ä¸¤éƒ¨åˆ†éœ€è¦å†æ¬¡æ ¹æ®PC-2è¿›è¡ŒæŒ‰ä½ç½®æ¢ã€‚ç”±äºŽCiå’ŒDiå…±æœ‰56ä½ï¼Œå› æ­¤PC-2éœ€è¦å¿½ç•¥å…¶ä¸­çš„8ä½ï¼Œåªç½®æ¢48ä½ã€‚ç½®æ¢å…³ç³»å¦‚ä¸‹ï¼š
![](files/3-4-5-3.png)

#### 3.4.6 DESçš„è§£å¯†è¿‡ç¨‹

DESçš„ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å…¶è§£å¯†è¿‡ç¨‹ä¸ŽåŠ å¯†è¿‡ç¨‹åœ¨æœ¬è´¨ä¸Šæ˜¯å®Œå…¨ç›¸åŒçš„ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºDESæ˜¯åŸºæœ¬Feistelç½‘ç»œã€‚ä¸ŽåŠ å¯†ç›¸åŒç›¸æ¯”ï¼Œè§£å¯†è¿‡ç¨‹ä¸­åªæœ‰å¯†é’¥ç¼–æŽ’é€†è½¬äº†ï¼Œå³è§£å¯†çš„ç¬¬ä¸€è½®éœ€è¦å­å¯†é’¥16ï¼›ç¬¬äºŒè½®éœ€è¦å­å¯†é’¥15ï¼›ä¾æ¬¡ç±»æŽ¨ã€‚

#### 3.4.7 DESè½¯ä»¶å®žçŽ°ä¸Žç¡¬ä»¶å®žçŽ°

**è½¯ä»¶**

æœ€ç®€å•ç›´è§‚çš„è½¯ä»¶å®žçŽ°éµå¾ªDESæè¿°çš„æ•°æ®æµï¼ŒæŒ‰éƒ¨å°±ç­è¿›è¡Œå®žçŽ°ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æ€§èƒ½é€šå¸¸è¾ƒå·®ï¼Œè¿™ä¸»è¦çš„æ˜¯å› ä¸ºå¾ˆå¤šåŽŸå­çº§çš„DESæ“ä½œéƒ½æ¶‰åŠåˆ°ä½ç½®æ¢ï¼Œå°¤å…¶æ˜¯Eç½®æ¢å’ŒPç½®æ¢ï¼Œè¿™ä¼šä½¿è½¯ä»¶å®žçŽ°å˜å¾—å¾ˆæ…¢ã€‚ä¸ºæ­¤ï¼Œäººä»¬æå‡ºäº†åŠ å¿«DESè½¯ä»¶å®žçŽ°çš„ç®—æ³•ï¼Œé€šå¸¸çš„æ€è·¯å°±æ˜¯ä½¿ç”¨ä¸€äº›è¡¨ï¼Œè¿™äº›è¡¨é‡Œçš„æ•°æ®æ¥è‡ªä¸€äº›DESæ“ä½œé¢„è®¡ç®—çš„å€¼ï¼Œæ¯”å¦‚ä¸€äº›S-ç›’é¢„è®¡ç®—å€¼å’Œç½®æ¢é¢„è®¡ç®—å€¼ã€‚

**ç¡¬ä»¶**

DESçš„ä¸€ä¸ªè®¾è®¡æ ‡å‡†å°±æ˜¯ç¡¬ä»¶å®žçŽ°æ•ˆçŽ‡ã€‚ç±»ä¼¼Eç½®æ¢ã€Pç½®æ¢ã€IPç½®æ¢ç­‰æ“ä½œï¼Œéžå¸¸æ˜“äºŽä½¿ç”¨ç¡¬ä»¶å®žçŽ°ï¼Œå› ä¸ºå®ƒä»¬åªéœ€è¦å¸ƒçº¿è€Œä¸éœ€è¦é€»è¾‘ã€S-ç›’åœ¨ç¡¬ä»¶å®žçŽ°ä¸Šä¹Ÿç›¸å½“ç®€å•ï¼Œé€šå¸¸å®ƒä»¬æ˜¯ä½¿ç”¨å¸ƒå°”é€»è¾‘å®žçŽ°çš„ï¼Œå³é€»è¾‘é—¨ç”µè·¯ï¼Œå¹³å‡ä¸‹æ¥ï¼Œä¸€ä¸ªS-ç›’å¤§æ¦‚éœ€è¦100ä¸ªé—¨ã€‚

### è¯¾å ‚å®žéªŒ

**åœ¨CAP4è½¯ä»¶ä¸­å®žçŽ°DESåŠ å¯†**

CAP4ä¸­æä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬çš„DESï¼Œå³æ ‡å‡†çš„DESå®žçŽ°å’Œä¸€ä¸ªå°åž‹ç‰ˆæœ¬ï¼ˆS-DESï¼‰ã€‚ä¸¤è€…æ“ä½œçš„æ–¹æ³•ç›¸åŒï¼Œéƒ½æ˜¯å…ˆè¾“å…¥æ˜Žæ–‡æˆ–å¯†æ–‡ï¼Œç„¶åŽé€‰å–Ciphersèœå•ä¸­DESæˆ–S-DESã€‚CAP4ä¸­çš„DESå®žçŽ°è¿˜æä¾›äº†ä¸€ä¸ªè¯„ä¼°é€‰é¡¹ï¼Œä½ å¯ä»¥å¯¹DESè¿›è¡Œä¸¤ç§ç±»åž‹çš„é›ªå´©æ¡ä»¶æµ‹è¯•ã€‚

### å·®åˆ†å¯†ç åˆ†æžä¸Žçº¿æ€§å¯†ç åˆ†æž

å·®åˆ†å¯†ç åˆ†æžæ˜¯è¿„ä»Šå·²çŸ¥çš„æ”»å‡»è¿­ä»£å¯†ç æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼š  é€šè¿‡åˆ†æžæ˜Žæ–‡å¯¹çš„å·®å€¼å¯¹å¯†æ–‡å¯¹çš„å·®å€¼çš„å½±å“æ¥æ¢å¤æŸäº›å¯†é’¥æ¯”ç‰¹ã€‚
çº¿æ€§å¯†ç åˆ†æžæ˜¯å¯¹è¿­ä»£å¯†ç çš„ä¸€ç§å·²çŸ¥æ˜Žæ–‡æ”»å‡»ï¼Œå®ƒåˆ©ç”¨çš„æ˜¯å¯†ç ç®—æ³•ä¸­çš„â€œä¸å¹³è¡¡ï¼ˆæœ‰æ•ˆï¼‰çš„çº¿æ€§é€¼è¿‘â€ã€‚

#### 3.5.1 å·®åˆ†å¯†ç åˆ†æž

å·®åˆ†å¯†ç åˆ†æžæ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œæ¯”è¾ƒå¯†æ–‡ä¸Žç›¸åº”çš„æ˜Žæ–‡ä¹‹é—´çš„å·®å¼‚ã€‚åŸºäºŽè¿™äº›å·®å¼‚ï¼Œå°±å¯ä»¥å¯¹å¯†é’¥çš„ä½è¿›è¡Œåˆç†çš„çŒœæµ‹ã€‚å·®åˆ†å¯†ç åˆ†æžåœ¨1990è¢«æå‡ºï¼Œç†è®ºä¸Šå®ƒå¯ä»¥ç ´ä»»ä½•åˆ†ç»„å¯†ç ï¼Œç„¶è€Œäº‹å®žè¯æ˜Žï¼ŒDESçš„S-ç›’å¯ä»¥å¾ˆå¥½åœ°æŠµæŠ—è¿™ç§æ”»å‡»ã€‚å®žé™…ä¸Šï¼Œåœ¨å·®åˆ†å¯†ç åˆ†æžè¢«å…¬å¸ƒåŽï¼Œä¸€ä½å‚ä¸Žè®¾è®¡DESå¯†ç çš„ç ”ç©¶å‘˜é€éœ²ï¼šä»–ä»¬åœ¨è®¾è®¡çš„æ—¶å€™å°±å·²ç»æ„è¯†åˆ°è¿™ç§æ”»å‡»çš„å­˜åœ¨ï¼Œæ®è¯´ï¼Œä¹‹æ‰€ä»¥æ²¡æœ‰å‘å…¬ä¼—å…¬å¸ƒS-ç›’è®¾è®¡æ ‡å‡†çš„åŽŸå› ä¹Ÿåœ¨äºŽï¼Œè®¾è®¡ç»„ä¸æƒ³å…¬å¼€å·®åˆ†å¯†ç åˆ†æžè¿™ç§å¼ºå¤§çš„æ”»å‡»æ‰‹æ®µã€‚å¦‚æžœè¿™æ˜¯çœŸçš„â€”â€”å½“ç„¶æ‰€æœ‰çš„äº‹å®žä¹Ÿæ”¯æŒè¿™ä¸ªè¯´æ³•â€”â€”è¿™æ„å‘³ç€IBMå’ŒNSAå°ç»„å·²ç»é¢†å…ˆå­¦æœ¯ç•Œ15å¹´ï¼Œå½“ç„¶ï¼Œåœ¨20æ—¶æœº70å¹´ä»£å’Œ80å¹´ä»£åªæœ‰ç›¸å½“å°‘çš„äººè¿˜åœ¨ç§¯æžç ”ç©¶å¯†ç å­¦ã€‚

#### 3.5.1 å·®åˆ†å¯†ç åˆ†æž

å¯¹åˆ†ç»„é•¿åº¦ä¸ºnçš„rè½®è¿­ä»£å¯†ç ï¼Œä¸¤ä¸ªnæ¯”ç‰¹ä¸²$Y_i$å’Œ$Y_i^{*-1}$çš„å·®åˆ†å®šä¹‰ä¸º
$$\Delta Y_i=Y_i \bigotimes Y_i^{*-1}$$
å…¶ä¸­$\bigotimes$è¡¨ç¤ºnæ¯”ç‰¹ä¸²é›†ä¸Šçš„ä¸€ä¸ªç‰¹å®šç¾¤è¿ç®—ï¼Œ$Y_i^{*-1}$è¡¨ç¤º$Y_i^{*}$åœ¨æ­¤ç¾¤ä¸­çš„é€†å…ƒã€‚
ç”±åŠ å¯†å¯¹å¯å¾—å·®åˆ†åºåˆ—
$$\Delta Y_{0}, \Delta Y_{1},..., \Delta Y_{r}$$
å…¶ä¸­$Y_0$å’Œ$Y_0^{*}$æ˜¯æ˜Žæ–‡å¯¹ï¼Œ$Y_i$å’Œ$Y_i^{*}$(1â‰¤iâ‰¤r)æ˜¯ç¬¬iè½®çš„è¾“å‡ºï¼Œå®ƒä»¬åŒæ—¶ä¹Ÿæ˜¯ç¬¬i+1è½®çš„è¾“å…¥ã€‚ç¬¬iè½®çš„å­å¯†é’¥è®°ä¸º$K_i$ï¼ŒFæ˜¯è½®å‡½æ•°ï¼Œä¸”$Y_i=F(Y_{i-1}, $K_i$)$ã€‚

![](files/3-5-1.png)

å¯¹r-è½®è¿­ä»£å¯†ç çš„å·®åˆ†å¯†ç åˆ†æžè¿‡ç¨‹å¯ç»¼è¿°ä¸ºå¦‚ä¸‹çš„æ­¥éª¤ï¼š
â‘  æ‰¾å‡ºä¸€ä¸ª(r-1)-è½®ç‰¹å¾$\Omega (r-1)=a_0,a_1,...,a_{r-1}$ï¼Œä½¿å¾—å®ƒçš„æ¦‚çŽ‡è¾¾åˆ°æœ€å¤§æˆ–å‡ ä¹Žæœ€å¤§ã€‚
â‘¡ å‡åŒ€éšæœºåœ°é€‰æ‹©æ˜Žæ–‡$Y_0$å¹¶è®¡ç®—$Y_0^{*}$ï¼Œä½¿å¾—$Y_0^{*}$å’Œ$Y_0^{*}$çš„å·®åˆ†ä¸º$a_0$ï¼Œæ‰¾å‡º$Y_0$å’Œ$Y_0^{*}$åœ¨å®žé™…å¯†é’¥åŠ å¯†ä¸‹æ‰€å¾—çš„å¯†æ–‡$Y_r$å’Œ$Y_r^{*}$ã€‚è‹¥æœ€åŽä¸€è½®çš„å­å¯†é’¥$K_r$ï¼ˆæˆ–$K_r$çš„éƒ¨åˆ†æ¯”ç‰¹ï¼‰æœ‰$2^m$ä¸ªå¯èƒ½å€¼$K_r^j$(1â‰¤jâ‰¤2m)ï¼Œè®¾ç½®ç›¸åº”çš„$2^m$ä¸ªè®¡æ•°å™¨$\Lambda_j$(1â‰¤jâ‰¤2m)ï¼›ç”¨æ¯ä¸ª$K_r^j$è§£å¯†å¯†æ–‡$K_r$å’Œ$Y_r^{*}$ï¼Œå¾—åˆ°$Y_{r-1}$å’Œ$Y_{r-1}^{*}$ï¼Œå¦‚æžœ$Y_{r-1}$å’Œ$Y_{r-1}^{*}$çš„å·®åˆ†æ˜¯$a_{r-1}$ï¼Œåˆ™ç»™ç›¸åº”çš„è®¡æ•°å™¨$\Lambda_j$åŠ 1ã€‚
â‘¢ é‡å¤æ­¥éª¤â‘¡ï¼Œç›´åˆ°ä¸€ä¸ªæˆ–å‡ ä¸ªè®¡æ•°å™¨çš„å€¼æ˜Žæ˜¾é«˜äºŽå…¶ä»–è®¡æ•°å™¨çš„å€¼ï¼Œè¾“å‡ºå®ƒä»¬æ‰€å¯¹åº”çš„å­å¯†é’¥ï¼ˆæˆ–éƒ¨åˆ†æ¯”ç‰¹ï¼‰ã€‚

#### 3.5.2 çº¿æ€§å¯†ç åˆ†æž

è®¾æ˜Žæ–‡åˆ†ç»„é•¿åº¦å’Œå¯†æ–‡åˆ†ç»„é•¿åº¦éƒ½ä¸ºnæ¯”ç‰¹ï¼Œå¯†é’¥åˆ†ç»„é•¿åº¦ä¸ºmæ¯”ç‰¹ã€‚è®°
æ˜Žæ–‡åˆ†ç»„ï¼šP[1]ï¼ŒP[2]ï¼Œâ€¦,P[n]ï¼Œ
å¯†æ–‡åˆ†ç»„ï¼šC[1]ï¼ŒC[2]ï¼Œâ€¦ï¼ŒC[n]ï¼Œ
å¯†é’¥åˆ†ç»„ï¼šK[1]ï¼ŒK[2]ï¼Œâ€¦ï¼ŒK[m]ã€‚

å®šä¹‰ï¼š

$$A[i,j,...,k]=A[i]\bigoplus A[j]\bigoplus ... \bigoplus A[k]$$

çº¿æ€§å¯†ç åˆ†æžçš„ç›®æ ‡å°±æ˜¯æ‰¾å‡ºä»¥ä¸‹å½¢å¼çš„æœ‰æ•ˆçº¿æ€§æ–¹ç¨‹ï¼š

$$P[i_1,i_2,...,i_a]\bigoplus C\bigoplus [j_1,j_2,...,j_b]=K[k_1,k_2,...,k_c]$$

å…¶ä¸­1â‰¤aâ‰¤n,1â‰¤bâ‰¤n,1â‰¤câ‰¤mã€‚
å¦‚æžœæ–¹ç¨‹æˆç«‹çš„æ¦‚çŽ‡pâ‰ 1/2ï¼Œåˆ™ç§°è¯¥æ–¹ç¨‹æ˜¯æœ‰æ•ˆçš„çº¿æ€§é€¼è¿‘ã€‚å¦‚æžœ|$p- \dfrac{1}{2}$|æ˜¯æœ€å¤§çš„ï¼Œåˆ™ç§°è¯¥æ–¹ç¨‹æ˜¯æœ€æœ‰æ•ˆçš„çº¿æ€§é€¼è¿‘ã€‚

è®¾Nè¡¨ç¤ºæ˜Žæ–‡æ•°ï¼ŒTæ˜¯ä½¿æ–¹ç¨‹å·¦è¾¹ä¸º0çš„æ˜Žæ–‡æ•°ã€‚å¦‚æžœT>N/2ï¼Œåˆ™ä»¤
![](files/3-5-2.png)
å¦‚æžœT<N/2ï¼Œåˆ™ä»¤
![](files/3-5-2-2.png)

ä»Žè€Œå¯å¾—å…³äºŽå¯†é’¥æ¯”ç‰¹çš„ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ã€‚å¯¹ä¸åŒçš„æ˜Žæ–‡å¯†æ–‡å¯¹é‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œå¯å¾—å…³äºŽå¯†é’¥çš„ä¸€ç»„çº¿æ€§æ–¹ç¨‹ï¼Œä»Žè€Œç¡®å®šå‡ºå¯†é’¥æ¯”ç‰¹ã€‚

![](files/3-5-2-3.png)

#### 3.5.3 å…¶ä»–å¯†ç åˆ†æžæ–¹æ³•

å¦‚ä½•å¯¹å·®åˆ†å¯†ç åˆ†æžå’Œçº¿æ€§å¯†ç åˆ†æžè¿›è¡Œæ”¹è¿›ï¼Œé™ä½Žå®ƒä»¬çš„å¤æ‚åº¦ä»æ˜¯çŽ°åœ¨ç†è®ºç ”ç©¶çš„çƒ­ç‚¹ï¼Œç›®å‰å·²æŽ¨å‡ºäº†å¾ˆå¤šæ”¹è¿›æ–¹æ³•ï¼Œä¾‹å¦‚,é«˜é˜¶å·®åˆ†å¯†ç åˆ†æžã€æˆªæ®µå·®åˆ†å¯†ç åˆ†æžï¼ˆtruncated differential cryptanalysisï¼‰ã€ä¸å¯èƒ½å·®åˆ†å¯†ç åˆ†æžã€å¤šé‡çº¿æ€§å¯†ç åˆ†æžã€éžçº¿æ€§å¯†ç åˆ†æžã€åˆ’åˆ†å¯†ç åˆ†æžå’Œå·®åˆ†-çº¿æ€§å¯†ç åˆ†æžï¼Œå†å¦‚é’ˆå¯¹å¯†é’¥ç¼–æŽ’ç®—æ³•çš„ç›¸å…³å¯†é’¥æ”»å‡»ã€åŸºäºŽLagrangeæ’å€¼å…¬å¼çš„æ’å€¼æ”»å‡»åŠåŸºäºŽå¯†ç å™¨ä»¶çš„èƒ½é‡åˆ†æžï¼ˆpower analysisï¼‰ï¼Œå¦å¤–è¿˜æœ‰é”™è¯¯æ”»å‡»ã€æ—¶é—´æ”»å‡»ã€Squareæ”»å‡»å’ŒDaviesæ”»å‡»ç­‰ã€‚
